[AI] Creating game with multiple AI opponents: {
  gameId: 'game_mj53r859',
  playerName: 'A2',
  aiCount: 2,
  aiNames: [ 'king', 'AI Opponent 2' ],
  aiDifficulties: [ 0.5, 0.5 ]
}
[GameManager] Created game game_mj53r859 using full rules engine (createInitialGameState)
[DB] Running insert: INSERT OR IGNORE INTO games (game_id, format, starting_life, created_at, created_by_socket_id, created_by_player_id) VALUES (?, ?, ?, ?, ?, ?)
[DB] Params: {
  gameId: 'game_mj53r859',
  format: 'commander',
  startingLife: 40,
  now: 1765679116732,
  createdBySocketId: undefined,
  createdByPlayerId: undefined
}
[DB] Running update: UPDATE games SET format = ?, starting_life = ? WHERE game_id = ?
[DB] Params: { format: 'commander', startingLife: 40, gameId: 'game_mj53r859' }
[AI] Created new game via GameManager: game_mj53r859
[AI] AI player joined game via game.join(): { aiPlayerId: 'p_pg87s2bm', aiName: 'king' }
[AI] Loading deck for king: { deckId: 'deck_1764197085965_ohucj3', deckName: 'King Maker' }
[DB] Running insert: INSERT OR IGNORE INTO games (game_id, format, starting_life, created_at, created_by_socket_id, created_by_player_id) VALUES (?, ?, ?, ?, ?, ?)
[DB] Params: {
  gameId: 'game_mj53r859',
  format: 'commander',
  startingLife: 40,
  now: 1765679116753,
  createdBySocketId: undefined,
  createdByPlayerId: undefined
}
[DB] Running update: UPDATE games SET format = ?, starting_life = ? WHERE game_id = ?
[DB] Params: { format: 'commander', startingLife: 40, gameId: 'game_mj53r859' }
joinGame incoming payload: {
  socketId: 'z2JLeAJLRNpdefPIAAAB',
  gameId: 'game_mj53r859',
  playerName: 'A2',
  spectator: false,
  seatToken: undefined,
  fixedPlayerId: undefined
}
joinGame: game.join returned { playerId: 'p_91foyham', added: true, resolvedToken: 't_cdo06aj1' }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 0, firstKnown: [] },
    p_91foyham: { handCount: 0, firstKnown: [] }
  }
}
[STATE_DEBUG] EMIT_JOIN_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham] zones=[p_pg87s2bm,p_91foyham] handCount=0 libraryCount=0
[STATE_DEBUG] EMIT_JOIN_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[join] Set game creator for game_mj53r859 to player p_91foyham
[Automation] Auto-pass for turn disabled for p_91foyham in game game_mj53r859
[Automation] Auto-pass for turn state in game game_mj53r859: {}
[Automation] Auto-pass enabled for p_91foyham in game game_mj53r859
[Automation] Auto-pass players in game game_mj53r859: [ 'p_91foyham' ]
[importDeckResolved] Importing 100 cards for player p_pg87s2bm
[importDeckResolved] Mapped 100 cards. First card: Kynaios and Tiro of Meletis (card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40)
[importDeckResolved] Library set for player p_pg87s2bm. Final library size: 100
[AI] Deck imported for king: {
  aiPlayerId: 'p_pg87s2bm',
  deckName: 'King Maker',
  resolvedCount: 100
}
[AI] Persisted deckImportResolved event for king: { aiPlayerId: 'p_pg87s2bm', cardCount: 100 }
[AI] Added AI player to auto-pass set: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[AI] Registered AI player: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  name: 'king',
  strategy: 'control',
  difficulty: 0.5
}
[AI] AI player joined game via game.join(): { aiPlayerId: 'p_zvvhcm6g', aiName: 'AI Opponent 2' }
[AI] Loading deck for AI Opponent 2: { deckId: 'deck_1764197024446_6ekrf1', deckName: 'Chatterfang' }
[deck] listSavedDecks called { gameId: 'game_mj53r859', folder: undefined, playerId: 'p_91foyham' }
[importDeckResolved] Importing 100 cards for player p_zvvhcm6g
[importDeckResolved] Mapped 100 cards. First card: Chatterfang, Squirrel General (card_1785cf85-1ac0-4246-9b89-1a8221a8e1b2_2fa567a98341dc57)
[importDeckResolved] Library set for player p_zvvhcm6g. Final library size: 100
[AI] Deck imported for AI Opponent 2: {
  aiPlayerId: 'p_zvvhcm6g',
  deckName: 'Chatterfang',
  resolvedCount: 100
}
[AI] Persisted deckImportResolved event for AI Opponent 2: { aiPlayerId: 'p_zvvhcm6g', cardCount: 100 }
[AI] Added AI player to auto-pass set: { gameId: 'game_mj53r859', playerId: 'p_zvvhcm6g' }
[AI] Registered AI player: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  name: 'AI Opponent 2',
  strategy: 'aggressive',
  difficulty: 0.5
}
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 0, firstKnown: [] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 0 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=0 libraryCount=100
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 0, firstKnown: [] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=0 libraryCount=100
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 0, firstKnown: [] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=0 libraryCount=100
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:22.119Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679122119_2pf49) ==========
2025-12-14T02:25:22.119Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:22.119Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679122119_2pf49)
[AI] Triggering auto-commander selection for: { gameId: 'game_mj53r859', aiPlayerId: 'p_pg87s2bm' }
[AI] Triggering auto-commander selection for: { gameId: 'game_mj53r859', aiPlayerId: 'p_zvvhcm6g' }
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: false,
  hasHand: false,
  handCount: 0,
  isAITurn: true,
  hasPriority: true
}
[AI] AI needs to select commander
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: false,
  hasHand: false,
  handCount: 0,
  isAITurn: true,
  hasPriority: true
}
[AI] AI needs to select commander
[AI] autoSelectAICommander: found library with 100 cards
[AI] First cards in library: [{"name":"Kynaios and Tiro of Meletis","type":"Legendary Creature — Human Soldier","colors":[]},{"name":"Arcane Denial","type":"Instant","colors":[]},{"name":"Azorius Chancery","type":"Land","colors":[]}]
[AI] Deck color identity: WURG
[AI] Selected single commander from first card (exact identity match): Kynaios and Tiro of Meletis
[AI] Auto-selecting commander for AI: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  commanderNames: [ 'Kynaios and Tiro of Meletis' ],
  commanderIds: [ 'card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40' ],
  colorIdentity: [ 'W', 'U', 'R', 'G' ]
}
[setCommander] Library size before commander removal: 100, Commander IDs to remove: [ 'card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40' ]
[setCommander] Found commander "Kynaios and Tiro of Meletis" (card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40) in library at index 0
[setCommander] Removing 1 commander(s) from library at indices: [ 0 ] library size before: 100
[setCommander] Removed card at index 0: Kynaios and Tiro of Meletis (card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40)
[setCommander] Library size after removal: 99
[setCommander] Updated zones[p_pg87s2bm].libraryCount to 99
[AI] After setCommander - hand count: 7
[AI] Persisted opening draw events (shuffle + draw) for player p_pg87s2bm
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:22.745Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679122745_1d83i) ==========
2025-12-14T02:25:22.745Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:22.745Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679122745_1d83i)
[AI] Commander set for AI player: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  commanderNames: [ 'Kynaios and Tiro of Meletis' ],
  finalHandCount: 7
}
[AI] Commander selection complete, continuing game flow
[AI] autoSelectAICommander: player already has commander, skipping {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  commanderIds: [ 'card_97fa8615-2b6c-445a-bcaf-44a7e847bf65_31943375a7d8fd40' ]
}
[AI] Commander selection complete, continuing game flow
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI evaluating hand for mulligan decision
[AI] AI making mulligan decision: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[AI] Mulligan analysis: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  handSize: 7,
  currentMulligans: 0,
  effectiveHandSizeAfterMulligan: 7,
  landCount: 3,
  manaSourceCount: 0,
  totalManaProduction: 3,
  lowCostSpellCount: 4,
  midCostSpellCount: 0,
  highCostSpellCount: 0
}
[AI] Hand has good land count (3-5 lands), keeping
[AI] AI keeping hand
[AI] AI is ready to start game (hand kept)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 0, firstKnown: [] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:23.052Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679123052_oatho) ==========
2025-12-14T02:25:23.052Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:23.052Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679123052_oatho)
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: false,
  hasHand: false,
  handCount: 0,
  isAITurn: false,
  hasPriority: false
}
[AI] AI needs to select commander
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] autoSelectAICommander: found library with 100 cards
[AI] First cards in library: [{"name":"Chatterfang, Squirrel General","type":"Legendary Creature — Squirrel Warrior","colors":[]},{"name":"Deep Forest Hermit","type":"Creature — Elf Druid","colors":[]},{"name":"Deranged Hermit","type":"Creature — Elf","colors":[]}]
[AI] Deck color identity: GBW
[AI] First commander identity [GB] does not match deck identity [GBW] - searching for better options
[AI] Selected single commander with closest match (score: 20, coverage: 2/3, extra colors: 0) [GB]: Chatterfang, Squirrel General - Deck identity [GBW]
[AI] Commander identity mismatch: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  commanders: 'Chatterfang, Squirrel General',
  commanderIdentity: 'GB',
  deckIdentity: 'GBW'
}
[AI] Auto-selecting commander for AI: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  commanderNames: [ 'Chatterfang, Squirrel General' ],
  commanderIds: [ 'card_1785cf85-1ac0-4246-9b89-1a8221a8e1b2_2fa567a98341dc57' ],
  colorIdentity: [ 'G', 'B' ]
}
[setCommander] Library size before commander removal: 100, Commander IDs to remove: [ 'card_1785cf85-1ac0-4246-9b89-1a8221a8e1b2_2fa567a98341dc57' ]
[setCommander] Found commander "Chatterfang, Squirrel General" (card_1785cf85-1ac0-4246-9b89-1a8221a8e1b2_2fa567a98341dc57) in library at index 0
[setCommander] Removing 1 commander(s) from library at indices: [ 0 ] library size before: 100
[setCommander] Removed card at index 0: Chatterfang, Squirrel General (card_1785cf85-1ac0-4246-9b89-1a8221a8e1b2_2fa567a98341dc57)
[setCommander] Library size after removal: 99
[setCommander] Updated zones[p_zvvhcm6g].libraryCount to 99
[AI] After setCommander - hand count: 7
[AI] Persisted opening draw events (shuffle + draw) for player p_zvvhcm6g
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:23.441Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679123441_gfst7) ==========
2025-12-14T02:25:23.441Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:23.441Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679123441_gfst7)
[AI] Commander set for AI player: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  commanderNames: [ 'Chatterfang, Squirrel General' ],
  finalHandCount: 7
}
[AI] Commander selection complete, continuing game flow
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[deck] canImportWithoutWipe {
  gameId: 'game_mj53r859',
  phaseStr: 'PRE_GAME',
  seqVal: 14,
  isPreGame: true
}
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: false,
  hasPriority: false
}
[AI] AI evaluating hand for mulligan decision
[AI] AI making mulligan decision: { gameId: 'game_mj53r859', playerId: 'p_zvvhcm6g' }
[AI] Mulligan analysis: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  handSize: 7,
  currentMulligans: 0,
  effectiveHandSizeAfterMulligan: 7,
  landCount: 2,
  manaSourceCount: 1,
  totalManaProduction: 3,
  lowCostSpellCount: 5,
  midCostSpellCount: 0,
  highCostSpellCount: 0
}
[AI] 2 lands with mana acceleration, keeping
[AI] AI keeping hand
[AI] AI is ready to start game (hand kept)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:23.949Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679123949_pxgwc) ==========
2025-12-14T02:25:23.949Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:23.949Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679123949_pxgwc)
[deck] importDeck called { gameId: 'game_mj53r859', playerId: 'p_91foyham' }
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_zvvhcm6g',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: false,
  hasPriority: false
}
[AI] AI has kept hand but is not active player, waiting
[deck] importDeck resolved cards {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  resolvedCount: 100,
  missingCount: 0,
  firstCard: {
    name: 'Baeloth Barrityl, Entertainer',
    id: 'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
    type_line: 'Legendary Creature — Elf Shaman'
  },
  lastCard: {
    name: 'Swamp',
    id: 'f0b234d8-d6bb-48ec-8a4d-d8a570a69c62_mj53rg2d_2s_fbfc7e6f',
    type_line: 'Basic Land — Swamp'
  }
}
[deck] importDeck pregame-check {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  phaseStr: 'PRE_GAME',
  seqVal: 15,
  isPreGame: true
}
[deck] clearPlayerTransientZonesForImport { gameId: 'game_mj53r859', playerId: 'p_91foyham' }
[deck] addPendingInitialDrawFlag {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  pendingInitialDrawSize: 1
}
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:24.762Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679124762_u22a4) ==========
2025-12-14T02:25:24.762Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:24.762Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679124762_u22a4)
[deck] importDeck (pre-game) emitting suggestCommanders {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  names: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ]
}
[deck] getImportedDeckCandidates {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  candidatesCount: 100
}
[import] applyConfirmedImport start {
  gameId: 'game_mj53r859',
  initiator: 'p_91foyham',
  cards: 100,
  importerOnly: true,
  confirmId: 'imp_1765679124759_cyq8xz'
}
[import] importer-only apply: skipping full reset { gameId: 'game_mj53r859' }
[importDeckResolved] Importing 100 cards for player p_91foyham
[importDeckResolved] Mapped 100 cards. First card: Baeloth Barrityl, Entertainer (ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5)
[importDeckResolved] Library set for player p_91foyham. Final library size: 100
[import] importDeckResolved attempted { gameId: 'game_mj53r859', playerId: 'p_91foyham' }
[import] state.zones libraryCount update (no library array duplication) { gameId: 'game_mj53r859', playerId: 'p_91foyham', libraryCount: 100 }
[deck] addPendingInitialDrawFlag {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  pendingInitialDrawSize: 1
}
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:24.979Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679124979_e1w29) ==========
2025-12-14T02:25:24.980Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:24.980Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679124979_e1w29)
[commander] emitImportedDeckCandidatesToPlayer {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  candidatesCount: 100
}
[commander] emitSuggestCommandersToPlayer {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  names: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ]
}
[import] suggestCommanders emitted (importerSocket) {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  names: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ]
}
[import] importApplied sent to player sockets { gameId: 'game_mj53r859', playerId: 'p_91foyham' }
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:24.984Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679124984_urkqn) ==========
2025-12-14T02:25:24.984Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:24.984Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679124984_urkqn)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 0, firstKnown: [] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:24.986Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679124986_g0q9k) ==========
2025-12-14T02:25:24.986Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:24.986Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679124986_g0q9k)
[import] applyConfirmedImport complete {
  gameId: 'game_mj53r859',
  initiator: 'p_91foyham',
  confirmId: 'imp_1765679124759_cyq8xz'
}
[deck] getImportedDeckCandidates {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  candidatesCount: 100
}
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[commander] setCommander incoming {
  gameId: 'game_mj53r859',
  from: 'p_91foyham',
  commanderNames: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ],
  commanderIds: [
    'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
    'f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5'
  ]
}
[commander] setCommander idsToApply {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  names: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ],
  idsToApply: [
    'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
    'f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5'
  ]
}
[commander-socket] Calling game.setCommander for player p_91foyham with names: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ] ids: [
  'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
  'f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5'
]
[setCommander] Library size before commander removal: 100, Commander IDs to remove: [
  'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
  'f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5'
]
[setCommander] Found commander "Baeloth Barrityl, Entertainer" (ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5) in library at index 0
[setCommander] Found commander "Agent of the Shadow Thieves" (f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5) in library at index 1
[setCommander] Removing 2 commander(s) from library at indices: [ 1, 0 ] library size before: 100
[setCommander] Removed card at index 1: Agent of the Shadow Thieves (f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5)
[setCommander] Removed card at index 0: Baeloth Barrityl, Entertainer (ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5)
[setCommander] Library size after removal: 98
[setCommander] Updated zones[p_91foyham].libraryCount to 98
[commander] Persisted opening draw events (shuffle + draw 7) for player p_91foyham
[DEBUG_CMD] after setCommander {
  gameId: 'game_mj53r859',
  playerId: 'p_91foyham',
  commanderIds: [
    'ec983aac-9eda-4086-ad7e-34da9b2987cc_mj53rg2d_1_ca4bf0c5',
    'f50448e9-afe4-4d4e-b027-bbb855f17aeb_mj53rg2d_2_7ca243b5'
  ],
  commanderNames: [ 'Baeloth Barrityl, Entertainer', 'Agent of the Shadow Thieves' ],
  libraryCount: 91,
  libraryTop: null
}
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:28.496Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679128496_r3dkf) ==========
2025-12-14T02:25:28.496Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:28.496Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679128496_r3dkf)
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] Waiting for other players to keep their hands
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=undefined, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:52.177Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679152177_vdhta) ==========
2025-12-14T02:25:52.177Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: pre_game, Step: undefined
2025-12-14T02:25:52.177Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679152177_vdhta)
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRE_GAME',
  step: '',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI is active player in pre_game, checking if ready to advance
[AI] All players ready, AI advancing from pre_game to beginning phase
2025-12-14T02:25:52.507Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:52.508Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:52.508Z [nextStep] Current: pre_game/
2025-12-14T02:25:52.508Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:52.508Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Module.handleAIGameFlow (D:\Git\MTGEDH\server\src\socket\ai.ts:998:27)
        at Timeout._onTimeout (D:\Git\MTGEDH\server\src\socket\util.ts:1350:28)
2025-12-14T02:25:52.508Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:52.508Z [nextStep] Advanced to phase=beginning, step=UPKEEP
2025-12-14T02:25:52.509Z [nextStep] Granting priority to active player p_pg87s2bm (step: UPKEEP, stack size: 0)
[canAct] p_pg87s2bm: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:52.510Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:52.510Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Forest, Plains, Minds Aglow, Seaside Citadel
2025-12-14T02:25:52.510Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:52.510Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:52.511Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Advanced game from pre_game to beginning phase
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=UPKEEP, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_pg87s2bm: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=92
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:52.515Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679152515_fjc9o) ==========
2025-12-14T02:25:52.515Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: beginning, Step: UPKEEP
2025-12-14T02:25:52.515Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679152515_fjc9o)
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'BEGINNING',
  step: 'UPKEEP',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'BEGINNING',
  step: 'UPKEEP',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'beginning',
  step: 'upkeep',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Beginning phase, step: upkeep - passing priority
[AI] Passing priority: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_pg87s2bm
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_zvvhcm6g - no available actions
[AI] All players passed priority with empty stack, advancing step
2025-12-14T02:25:53.141Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:53.141Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:53.141Z [nextStep] Current: beginning/UPKEEP
2025-12-14T02:25:53.142Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:53.142Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3532:25)
        at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
        at async handleAIPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:2141:7)
2025-12-14T02:25:53.142Z [nextStep] Advanced to phase=beginning, step=DRAW
2025-12-14T02:25:53.142Z [nextStep] Drew 1 card(s) for p_pg87s2bm at draw step (base: 1, additional: 0)
2025-12-14T02:25:53.142Z [nextStep] No draw triggers, immediately advancing to MAIN1 (similar to UNTAP->UPKEEP)
2025-12-14T02:25:53.142Z [nextStep] Advanced to MAIN1, found 0 precombat main trigger(s)
2025-12-14T02:25:53.142Z [nextStep] Granting priority to active player p_pg87s2bm (step: MAIN1, stack size: 0)
[canAct] p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 0 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Checking hand with 8 cards
[canPlayLand] p_pg87s2bm: Sample cards in hand: [Collective Voyage(Sorcery), Reins of Power(Instant), Soul Conduit(Artifact)]
[canPlayLand] p_pg87s2bm: Found land in hand: Forest (Basic Land — Forest) - returning TRUE
[canAct] p_pg87s2bm: Can play land - returning TRUE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:53.143Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:53.143Z [nextStep]   Hand (8): Collective Voyage, Reins of Power, Soul Conduit, Forest, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:53.143Z [nextStep]   canAct: true, canRespond: false
2025-12-14T02:25:53.143Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 0 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Checking hand with 8 cards
[canPlayLand] p_pg87s2bm: Sample cards in hand: [Collective Voyage(Sorcery), Reins of Power(Instant), Soul Conduit(Artifact)]
[canPlayLand] p_pg87s2bm: Found land in hand: Forest (Basic Land — Forest) - returning TRUE
[canAct] p_pg87s2bm: Can play land - returning TRUE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=true, stack.length=0, step=MAIN1
[priority] autoPassLoop - stopping at p_pg87s2bm: active player can act
2025-12-14T02:25:53.144Z [nextStep] Auto-pass stopped, player p_pg87s2bm has priority
[AI] Advanced to next step for game game_mj53r859
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 8, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Card Collective Voyage not playable - cannot pay cost {G} (after reduction: {"generic":0,"colors":{"W":0,"U":0,"B":0,"R":0,"G":1,"C":0},"hasX":false})
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Soul Conduit not playable - cannot pay cost {6} (after reduction: {"generic":6,"colors":{"W":0,"U":0,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Minds Aglow not playable - cannot pay cost {U} (after reduction: {"generic":0,"colors":{"W":0,"U":1,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Prismatic Geoscope not playable - cannot pay cost {5} (after reduction: {"generic":5,"colors":{"W":0,"U":0,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Checking lands: landsPlayed=0, max=1
[getPlayableCardIds] Land Forest (card_a305e44f-4253-4754-b83f-1e34103d77b0_883f51502325e91c) is playable
[getPlayableCardIds] Land Plains (card_4069fb4a-8ee1-41ef-ab93-39a8cc58e0e5_dc01c833cda7a199) is playable
[getPlayableCardIds] Land Seaside Citadel (card_a030b477-3093-4e66-b33d-530b302d795c_96a27d218df14bea) is playable
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=true, canPay=false
[getPlayableCardIds] Returning 3 playable card(s): [
  'card_a305e44f-4253-4754-b83f-1e34103d77b0_883f51502325e91c',
  'card_4069fb4a-8ee1-41ef-ab93-39a8cc58e0e5_dc01c833cda7a199',
  'card_a030b477-3093-4e66-b33d-530b302d795c_96a27d218df14bea'
]
[normalizeViewForEmit] getPlayableCardIds returned 3 cards
[normalizeViewForEmit] Set view.playableCards with 3 cards
[canAct] p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 0 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Checking hand with 8 cards
[canPlayLand] p_pg87s2bm: Sample cards in hand: [Collective Voyage(Sorcery), Reins of Power(Instant), Soul Conduit(Artifact)]
[canPlayLand] p_pg87s2bm: Found land in hand: Forest (Basic Land — Forest) - returning TRUE
[canAct] p_pg87s2bm: Can play land - returning TRUE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=true, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=8 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 8, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=8 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 8, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=8 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:53.149Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679153149_eoj7c) ==========
2025-12-14T02:25:53.149Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: precombatMain, Step: MAIN1
2025-12-14T02:25:53.149Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679153149_eoj7c)
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'precombatmain',
  step: 'main1',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Playing land: Forest
[AI] Playing land: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  cardId: 'card_a305e44f-4253-4754-b83f-1e34103d77b0_883f51502325e91c'
}
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[calculateMaxLandsPerTurn] Calculating for player p_zvvhcm6g, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_zvvhcm6g: 1 lands per turn
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[getDevotionManaAmount] Checking forest: { hasKarametra: false, hasAcolyte: false, fullCardName: 'forest' }
[getDevotionManaAmount] No match in KNOWN_DEVOTION_MANA_CARDS, trying dynamic detection
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_pg87s2bm, match=true
[getPlayableCardIds] Player p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 1, colorless: 0 }
[getPlayableCardIds] Total available mana: 1
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Card Collective Voyage (card_3f2d44f0-c71e-4061-bb7c-1f91fbce8f51_07b62835ef14ad57) is playable
[getPlayableCardIds] Card Reins of Power not playable - cannot pay cost {2}{U}{U} (after reduction: {"generic":2,"colors":{"W":0,"U":2,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Soul Conduit not playable - cannot pay cost {6} (after reduction: {"generic":6,"colors":{"W":0,"U":0,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Minds Aglow not playable - cannot pay cost {U} (after reduction: {"generic":0,"colors":{"W":0,"U":1,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Card Prismatic Geoscope not playable - cannot pay cost {5} (after reduction: {"generic":5,"colors":{"W":0,"U":0,"B":0,"R":0,"G":0,"C":0},"hasX":false})
[getPlayableCardIds] Checking lands: landsPlayed=1, max=1
[getPlayableCardIds] Already played max lands this turn (1/1)
[getPlayableCardIds] Checking 1 commanders in command zone
[getPlayableCardIds] Commander Kynaios and Tiro of Meletis not playable - canCastNow=true, canPay=false
[getPlayableCardIds] Returning 1 playable card(s): [ 'card_3f2d44f0-c71e-4061-bb7c-1f91fbce8f51_07b62835ef14ad57' ]
[normalizeViewForEmit] getPlayableCardIds returned 1 cards
[normalizeViewForEmit] Set view.playableCards with 1 cards
[canAct] p_pg87s2bm: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Already played max lands this turn (1/1)
[canAct] p_pg87s2bm: Can cast sorcery-speed spell - returning TRUE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=true, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[getDevotionManaAmount] Checking forest: { hasKarametra: false, hasAcolyte: false, fullCardName: 'forest' }
[getDevotionManaAmount] No match in KNOWN_DEVOTION_MANA_CARDS, trying dynamic detection
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[getDevotionManaAmount] Checking forest: { hasKarametra: false, hasAcolyte: false, fullCardName: 'forest' }
[getDevotionManaAmount] No match in KNOWN_DEVOTION_MANA_CARDS, trying dynamic detection
[normalizeViewForEmit] Checking playable cards: priority=p_pg87s2bm, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:53.361Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679153361_bpg4m) ==========
2025-12-14T02:25:53.361Z [checkAndTriggerAutoPass] Priority: p_pg87s2bm, Phase: precombatMain, Step: MAIN1
2025-12-14T02:25:53.362Z [checkAndTriggerAutoPass] p_pg87s2bm is AI, handled separately (ID: autopass_1765679153361_bpg4m)
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'precombatmain',
  step: 'main1',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Cannot play land: {
  isMainPhase: true,
  isAITurn: true,
  landsPlayed: 1,
  maxLands: 1,
  reason: 'already played max lands'
}
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRECOMBATMAIN',
  step: 'MAIN1',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] handleAIGameFlow: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'PRECOMBATMAIN',
  step: 'MAIN1',
  hasCommander: true,
  hasHand: true,
  handCount: 7,
  isAITurn: true,
  hasPriority: true
}
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'precombatmain',
  step: 'main1',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Cannot play land: {
  isMainPhase: true,
  isAITurn: true,
  landsPlayed: 1,
  maxLands: 1,
  reason: 'already played max lands'
}
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'precombatmain',
  step: 'main1',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Cannot play land: {
  isMainPhase: true,
  isAITurn: true,
  landsPlayed: 1,
  maxLands: 1,
  reason: 'already played max lands'
}
[AI] Activating ability: Forest - Activating Forest (value: 6.5)
[AI] Activating ability: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  cardName: 'Forest',
  permanentId: 'perm_ukj18yba'
}
[AI] Tapped permanent for ability: Forest
[AI] Tapped for mana ability (resolves immediately, not on stack): Forest
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'precombatmain',
  step: 'main1',
  isAITurn: true,
  stackEmpty: true,
  priority: 'p_pg87s2bm',
  hasPriority: true
}
[AI] AI has priority, proceeding with action
[AI] Cannot play land: {
  isMainPhase: true,
  isAITurn: true,
  landsPlayed: 1,
  maxLands: 1,
  reason: 'already played max lands'
}
[AI] Main phase, no more actions, passing priority
[AI] Passing priority: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_pg87s2bm
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=MAIN1
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=MAIN1
[priority] Auto-passing for p_zvvhcm6g - no available actions
[AI] All players passed priority with empty stack, advancing step
2025-12-14T02:25:54.277Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.277Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.277Z [nextStep] Current: precombatMain/MAIN1
2025-12-14T02:25:54.277Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.277Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3532:25)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.277Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.277Z [nextStep] Advanced to phase=combat, step=BEGIN_COMBAT
[getBeginningOfCombatTriggers] Total triggers for activePlayer=p_pg87s2bm: 0
2025-12-14T02:25:54.278Z [nextStep] Granting priority to active player p_pg87s2bm (step: BEGIN_COMBAT, stack size: 0)
[canAct] p_pg87s2bm: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.278Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.278Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.278Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.278Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.279Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Advanced to next step for game game_mj53r859
[AI] Auto-pass detected after step advancement (iteration 1), advancing again
2025-12-14T02:25:54.280Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.280Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.280Z [nextStep] Current: combat/BEGIN_COMBAT
2025-12-14T02:25:54.280Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.280Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.280Z [nextStep] Advanced to phase=combat, step=DECLARE_ATTACKERS
2025-12-14T02:25:54.280Z [nextStep] Granting priority to active player p_pg87s2bm (step: DECLARE_ATTACKERS, stack size: 0)
[canAct] p_pg87s2bm: step=DECLARE_ATTACKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.280Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.280Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.280Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.280Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=DECLARE_ATTACKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.281Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to DECLARE_ATTACKERS
[AI] Auto-pass detected after step advancement (iteration 2), advancing again
2025-12-14T02:25:54.281Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.281Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.281Z [nextStep] Current: combat/DECLARE_ATTACKERS
2025-12-14T02:25:54.281Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.281Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.281Z [nextStep] Advanced to phase=combat, step=DECLARE_BLOCKERS
2025-12-14T02:25:54.282Z [nextStep] Granting priority to active player p_pg87s2bm (step: DECLARE_BLOCKERS, stack size: 0)
[canAct] p_pg87s2bm: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.282Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.282Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.282Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.282Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.283Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to DECLARE_BLOCKERS
[AI] Auto-pass detected after step advancement (iteration 3), advancing again
2025-12-14T02:25:54.283Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.283Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.283Z [nextStep] Current: combat/DECLARE_BLOCKERS
2025-12-14T02:25:54.283Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.283Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.283Z [COMBAT_STEP] ========== TRANSITIONING FROM DECLARE_BLOCKERS TO DAMAGE (no first strike) ==========
2025-12-14T02:25:54.283Z [COMBAT_STEP] Calling dealCombatDamage...
2025-12-14T02:25:54.284Z [COMBAT_DAMAGE] ========== ENTERING dealCombatDamage (firstStrike=undefined) ==========
2025-12-14T02:25:54.284Z [COMBAT_DAMAGE] Found 0 attackers
2025-12-14T02:25:54.284Z [COMBAT_DAMAGE] No attackers, skipping combat damage
2025-12-14T02:25:54.284Z [COMBAT_STEP] dealCombatDamage completed successfully
2025-12-14T02:25:54.284Z [COMBAT_STEP] Result: damageToPlayers={}, creaturesDestroyed=0
2025-12-14T02:25:54.284Z [COMBAT_STEP] ========== END DAMAGE STEP PROCESSING ==========
2025-12-14T02:25:54.284Z [nextStep] Advanced to phase=combat, step=DAMAGE
2025-12-14T02:25:54.284Z [nextStep] Granting priority to active player p_pg87s2bm (step: DAMAGE, stack size: 0)
[canAct] p_pg87s2bm: step=DAMAGE, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.285Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.285Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.285Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.285Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=DAMAGE, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.286Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to DAMAGE
[AI] Auto-pass detected after step advancement (iteration 4), advancing again
2025-12-14T02:25:54.286Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.286Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.286Z [nextStep] Current: combat/DAMAGE
2025-12-14T02:25:54.286Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.286Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.286Z [nextStep] Advanced to phase=combat, step=END_COMBAT
2025-12-14T02:25:54.286Z [nextStep] Granting priority to active player p_pg87s2bm (step: END_COMBAT, stack size: 0)
[canAct] p_pg87s2bm: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.287Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.287Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.287Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.287Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.287Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to END_COMBAT
[AI] Auto-pass detected after step advancement (iteration 5), advancing again
2025-12-14T02:25:54.288Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.288Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.288Z [nextStep] Current: combat/END_COMBAT
2025-12-14T02:25:54.288Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.288Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.288Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.288Z [nextStep] Advanced to phase=postcombatMain, step=MAIN2
2025-12-14T02:25:54.288Z [nextStep] Granting priority to active player p_pg87s2bm (step: MAIN2, stack size: 0)
[canAct] p_pg87s2bm: step=MAIN2, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Already played max lands this turn (1/1)
[canAct] p_pg87s2bm: No sorcery-speed actions available in main phase - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.289Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.289Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.289Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.289Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=MAIN2, isMainPhase=true, stackIsEmpty=true
[canAct] p_pg87s2bm: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[canPlayLand] p_pg87s2bm: Already played max lands this turn (1/1)
[canAct] p_pg87s2bm: No sorcery-speed actions available in main phase - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=MAIN2
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=MAIN2
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=MAIN2
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.290Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to MAIN2
[AI] Auto-pass detected after step advancement (iteration 6), advancing again
2025-12-14T02:25:54.291Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.291Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.291Z [nextStep] Current: postcombatMain/MAIN2
2025-12-14T02:25:54.291Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.291Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.291Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.291Z [nextStep] Advanced to phase=ending, step=END
2025-12-14T02:25:54.292Z [nextStep] Granting priority to active player p_pg87s2bm (step: END, stack size: 0)
[canAct] p_pg87s2bm: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
2025-12-14T02:25:54.292Z [nextStep] DEBUG - Turn Player p_pg87s2bm:
2025-12-14T02:25:54.292Z [nextStep]   Hand (7): Collective Voyage, Reins of Power, Soul Conduit, Plains, Minds Aglow, Seaside Citadel, Prismatic Geoscope
2025-12-14T02:25:54.292Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.292Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_pg87s2bm, turnPlayer: p_pg87s2bm
[canAct] p_pg87s2bm: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_pg87s2bm: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_pg87s2bm: No actions available - returning FALSE
[priority] autoPassLoop - checking p_pg87s2bm (ACTIVE): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_pg87s2bm - no available actions
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_91foyham (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_zvvhcm6g - no available actions
2025-12-14T02:25:54.293Z [nextStep] All players auto-passed after granting priority - caller should advance step
[AI] Auto-advanced to END
[AI] Auto-pass detected after step advancement (iteration 7), advancing again
2025-12-14T02:25:54.293Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.293Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.293Z [nextStep] Current: ending/END
2025-12-14T02:25:54.293Z [nextStep] Priority: p_pg87s2bm, Turn: p_pg87s2bm
2025-12-14T02:25:54.294Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at executePassPriority (D:\Git\MTGEDH\server\src\socket\ai.ts:3557:29)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at process.processTimers (node:internal/timers:520:9)
2025-12-14T02:25:54.294Z [nextStep] Advanced to phase=ending, step=CLEANUP
2025-12-14T02:25:54.294Z [nextStep] Step CLEANUP does not grant priority (Rule 502.1/514.1)
2025-12-14T02:25:54.294Z [nextStep] Cleanup complete, advancing to next turn
2025-12-14T02:25:54.294Z [nextTurn] Cleared autoPassForTurn flags for new turn
2025-12-14T02:25:54.295Z [nextTurn] Advanced to player p_91foyham, phase=beginning, step=UPKEEP
2025-12-14T02:25:54.295Z [nextTurn] Checking if auto-pass should apply at upkeep
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.295Z [nextTurn] All players auto-passed at upkeep - caller should advance step
[calculateMaxLandsPerTurn] Calculating for player p_pg87s2bm, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_pg87s2bm: 1 lands per turn
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[calculateMaxLandsPerTurn] Calculating for player p_zvvhcm6g, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_zvvhcm6g: 1 lands per turn
[AI] Auto-advanced to UPKEEP
[AI] Auto-pass loop stopping - human player p_91foyham has priority
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.299Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154299_pcz7r) ==========
2025-12-14T02:25:54.299Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: beginning, Step: UPKEEP
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.299Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.299Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.299Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154299_pcz7r)
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'beginning',
  step: 'upkeep',
  isAITurn: false,
  stackEmpty: true,
  priority: 'p_91foyham',
  hasPriority: false
}
[AI] AI does not have priority, skipping action
[Automation] Auto-pass for turn disabled for p_91foyham in game game_mj53r859
[Automation] Auto-pass for turn state in game game_mj53r859: {}
[AI] Main phase, no more actions, passing priority
[AI] Passing priority: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 7 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 7, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.388Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154388_pcurl) ==========
2025-12-14T02:25:54.388Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: beginning, Step: UPKEEP
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.389Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.389Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.389Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.461Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154299_pcz7r) ==========
2025-12-14T02:25:54.461Z [executeAutoPass] Phase: beginning, Step: UPKEEP
[canAct] p_91foyham: step=UPKEEP, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.462Z [executeAutoPass] Re-check: p_91foyham canAct=false (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.462Z [executeAutoPass] Proceeding with auto-pass for p_91foyham (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.462Z [executeAutoPass] Set _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154299_pcz7r)
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_zvvhcm6g, turnPlayer: p_91foyham
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=UPKEEP
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.463Z [executeAutoPass] passPriority result: changed=true, advanceStep=true, resolvedNow=false (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.469Z [executeAutoPass] Advancing step after auto-pass for p_91foyham (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.469Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.469Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.469Z [nextStep] Current: beginning/UPKEEP
2025-12-14T02:25:54.469Z [nextStep] Priority: p_zvvhcm6g, Turn: p_91foyham
2025-12-14T02:25:54.469Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1600:31)
        at listOnTimeout (node:internal/timers:588:17)
        at process.processTimers (node:internal/timers:523:7)
2025-12-14T02:25:54.469Z [nextStep] Advanced to phase=beginning, step=DRAW
2025-12-14T02:25:54.469Z [nextStep] Drew 1 card(s) for p_91foyham at draw step (base: 1, additional: 0)
2025-12-14T02:25:54.470Z [nextStep] No draw triggers, immediately advancing to MAIN1 (similar to UNTAP->UPKEEP)
2025-12-14T02:25:54.470Z [nextStep] Advanced to MAIN1, found 0 precombat main trigger(s)
2025-12-14T02:25:54.470Z [nextStep] Granting priority to active player p_91foyham (step: MAIN1, stack size: 0)
[canAct] p_91foyham: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_91foyham: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[canPlayLand] p_91foyham: Checking hand with 8 cards
[canPlayLand] p_91foyham: Sample cards in hand: [Luxury Suite(Land), Mountain(Basic Land — Mountai), Laser Screwdriver(Artifact)]
[canPlayLand] p_91foyham: Found land in hand: Luxury Suite (Land) - returning TRUE
[canAct] p_91foyham: Can play land - returning TRUE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.471Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.471Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.471Z [nextStep]   canAct: true, canRespond: false
2025-12-14T02:25:54.471Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=MAIN1, isMainPhase=true, stackIsEmpty=true
[canAct] p_91foyham: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[canPlayLand] p_91foyham: Checking hand with 8 cards
[canPlayLand] p_91foyham: Sample cards in hand: [Luxury Suite(Land), Mountain(Basic Land — Mountai), Laser Screwdriver(Artifact)]
[canPlayLand] p_91foyham: Found land in hand: Luxury Suite (Land) - returning TRUE
[canAct] p_91foyham: Can play land - returning TRUE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=true, stack.length=0, step=MAIN1
[priority] autoPassLoop - stopping at p_91foyham: active player can act
2025-12-14T02:25:54.471Z [nextStep] Auto-pass stopped, player p_91foyham has priority
2025-12-14T02:25:54.474Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.474Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.474Z [nextStep] Current: precombatMain/MAIN1
2025-12-14T02:25:54.474Z [nextStep] Priority: p_91foyham, Turn: p_91foyham
2025-12-14T02:25:54.474Z [nextStep] Call stack:
        at applyEvent (D:\Git\MTGEDH\server\src\state\modules\applyEvent.ts:742:9)
        at Object.applyEvent (D:\Git\MTGEDH\server\src\state\index.ts:202:35)
        at appendGameEvent (D:\Git\MTGEDH\server\src\socket\util.ts:1659:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1602:15)
2025-12-14T02:25:54.474Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.474Z [nextStep] Advanced to phase=combat, step=BEGIN_COMBAT
[getBeginningOfCombatTriggers] Total triggers for activePlayer=p_91foyham: 0
2025-12-14T02:25:54.474Z [nextStep] Granting priority to active player p_91foyham (step: BEGIN_COMBAT, stack size: 0)
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.475Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.475Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.475Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.475Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.476Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.477Z [executeAutoPass] Cleared _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154299_pcz7r)
2025-12-14T02:25:54.477Z [executeAutoPass] Broadcasting state after auto-pass (ID: autopass_1765679154299_pcz7r)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.480Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154480_em8oa) ==========
2025-12-14T02:25:54.480Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: combat, Step: BEGIN_COMBAT
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.481Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.481Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.481Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.481Z [executeAutoPass] Broadcast complete (ID: autopass_1765679154299_pcz7r)
[AI] AI player checking priority: {
  gameId: 'game_mj53r859',
  playerId: 'p_pg87s2bm',
  phase: 'combat',
  step: 'begin_combat',
  isAITurn: false,
  stackEmpty: true,
  priority: 'p_91foyham',
  hasPriority: false
}
[AI] AI does not have priority, skipping action
[AI] Main phase, no more actions, passing priority
[AI] Passing priority: { gameId: 'game_mj53r859', playerId: 'p_pg87s2bm' }
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.488Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154488_12fej) ==========
2025-12-14T02:25:54.488Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: combat, Step: BEGIN_COMBAT
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.488Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.488Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.488Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.551Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154388_pcurl) ==========
2025-12-14T02:25:54.551Z [executeAutoPass] Phase: combat, Step: BEGIN_COMBAT
[canAct] p_91foyham: step=BEGIN_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.552Z [executeAutoPass] Re-check: p_91foyham canAct=false (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.552Z [executeAutoPass] Proceeding with auto-pass for p_91foyham (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.552Z [executeAutoPass] Set _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154388_pcurl)
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_zvvhcm6g, turnPlayer: p_91foyham
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=BEGIN_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.553Z [executeAutoPass] passPriority result: changed=true, advanceStep=true, resolvedNow=false (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.553Z [executeAutoPass] Advancing step after auto-pass for p_91foyham (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.553Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.554Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.554Z [nextStep] Current: combat/BEGIN_COMBAT
2025-12-14T02:25:54.554Z [nextStep] Priority: p_zvvhcm6g, Turn: p_91foyham
2025-12-14T02:25:54.554Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1600:31)
        at listOnTimeout (node:internal/timers:588:17)
        at process.processTimers (node:internal/timers:523:7)
2025-12-14T02:25:54.554Z [nextStep] Advanced to phase=combat, step=DECLARE_ATTACKERS
2025-12-14T02:25:54.554Z [nextStep] Granting priority to active player p_91foyham (step: DECLARE_ATTACKERS, stack size: 0)
[canAct] p_91foyham: step=DECLARE_ATTACKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.554Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.554Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.554Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.554Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=DECLARE_ATTACKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=DECLARE_ATTACKERS
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.555Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.555Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.555Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.555Z [nextStep] Current: combat/DECLARE_ATTACKERS
2025-12-14T02:25:54.555Z [nextStep] Priority: p_91foyham, Turn: p_91foyham
2025-12-14T02:25:54.555Z [nextStep] Call stack:
        at applyEvent (D:\Git\MTGEDH\server\src\state\modules\applyEvent.ts:742:9)
        at Object.applyEvent (D:\Git\MTGEDH\server\src\state\index.ts:202:35)
        at appendGameEvent (D:\Git\MTGEDH\server\src\socket\util.ts:1659:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1602:15)
2025-12-14T02:25:54.555Z [nextStep] Advanced to phase=combat, step=DECLARE_BLOCKERS
2025-12-14T02:25:54.556Z [nextStep] Granting priority to active player p_91foyham (step: DECLARE_BLOCKERS, stack size: 0)
[canAct] p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.556Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.556Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.556Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.556Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.557Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.557Z [executeAutoPass] Cleared _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.558Z [executeAutoPass] Broadcasting state after auto-pass (ID: autopass_1765679154388_pcurl)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.560Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154560_8buby) ==========
2025-12-14T02:25:54.560Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: combat, Step: DECLARE_BLOCKERS
[canAct] p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.561Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.561Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.561Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.561Z [executeAutoPass] Broadcast complete (ID: autopass_1765679154388_pcurl)
2025-12-14T02:25:54.645Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154480_em8oa) ==========
2025-12-14T02:25:54.645Z [executeAutoPass] Phase: combat, Step: DECLARE_BLOCKERS
[canAct] p_91foyham: step=DECLARE_BLOCKERS, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.645Z [executeAutoPass] Re-check: p_91foyham canAct=false (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.645Z [executeAutoPass] Proceeding with auto-pass for p_91foyham (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.645Z [executeAutoPass] Set _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154480_em8oa)
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_zvvhcm6g, turnPlayer: p_91foyham
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=DECLARE_BLOCKERS
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.646Z [executeAutoPass] passPriority result: changed=true, advanceStep=true, resolvedNow=false (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.646Z [executeAutoPass] Advancing step after auto-pass for p_91foyham (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.646Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.646Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.647Z [nextStep] Current: combat/DECLARE_BLOCKERS
2025-12-14T02:25:54.647Z [nextStep] Priority: p_zvvhcm6g, Turn: p_91foyham
2025-12-14T02:25:54.647Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1600:31)
        at listOnTimeout (node:internal/timers:588:17)
        at process.processTimers (node:internal/timers:523:7)
2025-12-14T02:25:54.647Z [COMBAT_STEP] ========== TRANSITIONING FROM DECLARE_BLOCKERS TO DAMAGE (no first strike) ==========
2025-12-14T02:25:54.647Z [COMBAT_STEP] Calling dealCombatDamage...
2025-12-14T02:25:54.647Z [COMBAT_DAMAGE] ========== ENTERING dealCombatDamage (firstStrike=undefined) ==========
2025-12-14T02:25:54.647Z [COMBAT_DAMAGE] Found 0 attackers
2025-12-14T02:25:54.647Z [COMBAT_DAMAGE] No attackers, skipping combat damage
2025-12-14T02:25:54.647Z [COMBAT_STEP] dealCombatDamage completed successfully
2025-12-14T02:25:54.647Z [COMBAT_STEP] Result: damageToPlayers={}, creaturesDestroyed=0
2025-12-14T02:25:54.647Z [COMBAT_STEP] ========== END DAMAGE STEP PROCESSING ==========
2025-12-14T02:25:54.647Z [nextStep] Advanced to phase=combat, step=DAMAGE
2025-12-14T02:25:54.647Z [nextStep] Granting priority to active player p_91foyham (step: DAMAGE, stack size: 0)
[canAct] p_91foyham: step=DAMAGE, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.647Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.647Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.647Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.648Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=DAMAGE, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=DAMAGE
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.648Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.648Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.648Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.648Z [nextStep] Current: combat/DAMAGE
2025-12-14T02:25:54.649Z [nextStep] Priority: p_91foyham, Turn: p_91foyham
2025-12-14T02:25:54.649Z [nextStep] Call stack:
        at applyEvent (D:\Git\MTGEDH\server\src\state\modules\applyEvent.ts:742:9)
        at Object.applyEvent (D:\Git\MTGEDH\server\src\state\index.ts:202:35)
        at appendGameEvent (D:\Git\MTGEDH\server\src\socket\util.ts:1659:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1602:15)
2025-12-14T02:25:54.649Z [nextStep] Advanced to phase=combat, step=END_COMBAT
2025-12-14T02:25:54.649Z [nextStep] Granting priority to active player p_91foyham (step: END_COMBAT, stack size: 0)
[canAct] p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.649Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.649Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.649Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.649Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.650Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.650Z [executeAutoPass] Cleared _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.650Z [executeAutoPass] Broadcasting state after auto-pass (ID: autopass_1765679154480_em8oa)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.653Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154653_7naee) ==========
2025-12-14T02:25:54.654Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: combat, Step: END_COMBAT
[canAct] p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.654Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154653_7naee)
2025-12-14T02:25:54.654Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154653_7naee)
2025-12-14T02:25:54.654Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154653_7naee)
2025-12-14T02:25:54.654Z [executeAutoPass] Broadcast complete (ID: autopass_1765679154480_em8oa)
2025-12-14T02:25:54.654Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154488_12fej) ==========
2025-12-14T02:25:54.654Z [executeAutoPass] Phase: combat, Step: END_COMBAT
[canAct] p_91foyham: step=END_COMBAT, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.655Z [executeAutoPass] Re-check: p_91foyham canAct=false (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.655Z [executeAutoPass] Proceeding with auto-pass for p_91foyham (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.655Z [executeAutoPass] Set _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154488_12fej)
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_zvvhcm6g, turnPlayer: p_91foyham
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=END_COMBAT
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.656Z [executeAutoPass] passPriority result: changed=true, advanceStep=true, resolvedNow=false (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.656Z [executeAutoPass] Advancing step after auto-pass for p_91foyham (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.656Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.656Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.656Z [nextStep] Current: combat/END_COMBAT
2025-12-14T02:25:54.656Z [nextStep] Priority: p_zvvhcm6g, Turn: p_91foyham
2025-12-14T02:25:54.656Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1600:31)
        at listOnTimeout (node:internal/timers:588:17)
        at process.processTimers (node:internal/timers:523:7)
2025-12-14T02:25:54.656Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.657Z [nextStep] Advanced to phase=postcombatMain, step=MAIN2
2025-12-14T02:25:54.657Z [nextStep] Granting priority to active player p_91foyham (step: MAIN2, stack size: 0)
[canAct] p_91foyham: step=MAIN2, isMainPhase=true, stackIsEmpty=true
[canAct] p_91foyham: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[canPlayLand] p_91foyham: Checking hand with 8 cards
[canPlayLand] p_91foyham: Sample cards in hand: [Luxury Suite(Land), Mountain(Basic Land — Mountai), Laser Screwdriver(Artifact)]
[canPlayLand] p_91foyham: Found land in hand: Luxury Suite (Land) - returning TRUE
[canAct] p_91foyham: Can play land - returning TRUE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.657Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.657Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.657Z [nextStep]   canAct: true, canRespond: false
2025-12-14T02:25:54.657Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=MAIN2, isMainPhase=true, stackIsEmpty=true
[canAct] p_91foyham: In main phase with empty stack, checking sorcery-speed actions
[calculateMaxLandsPerTurn] Calculating for player p_91foyham, battlefield has 1 permanents
[calculateMaxLandsPerTurn] Final result for p_91foyham: 1 lands per turn
[canPlayLand] p_91foyham: Checking hand with 8 cards
[canPlayLand] p_91foyham: Sample cards in hand: [Luxury Suite(Land), Mountain(Basic Land — Mountai), Laser Screwdriver(Artifact)]
[canPlayLand] p_91foyham: Found land in hand: Luxury Suite (Land) - returning TRUE
[canAct] p_91foyham: Can play land - returning TRUE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=true, stack.length=0, step=MAIN2
[priority] autoPassLoop - stopping at p_91foyham: active player can act
2025-12-14T02:25:54.658Z [nextStep] Auto-pass stopped, player p_91foyham has priority
2025-12-14T02:25:54.658Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.658Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.658Z [nextStep] Current: postcombatMain/MAIN2
2025-12-14T02:25:54.658Z [nextStep] Priority: p_91foyham, Turn: p_91foyham
2025-12-14T02:25:54.658Z [nextStep] Call stack:
        at applyEvent (D:\Git\MTGEDH\server\src\state\modules\applyEvent.ts:742:9)
        at Object.applyEvent (D:\Git\MTGEDH\server\src\state\index.ts:202:35)
        at appendGameEvent (D:\Git\MTGEDH\server\src\socket\util.ts:1659:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1602:15)
2025-12-14T02:25:54.658Z [clearManaPool] Processed mana pools for all players
2025-12-14T02:25:54.658Z [nextStep] Advanced to phase=ending, step=END
2025-12-14T02:25:54.658Z [nextStep] Granting priority to active player p_91foyham (step: END, stack size: 0)
[canAct] p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
2025-12-14T02:25:54.659Z [nextStep] DEBUG - Turn Player p_91foyham:
2025-12-14T02:25:54.659Z [nextStep]   Hand (8): Luxury Suite, Mountain, Laser Screwdriver, Ozai, the Phoenix King, Mountain, Coronation of Chaos, Pariah's Shield, Donna Noble
2025-12-14T02:25:54.659Z [nextStep]   canAct: false, canRespond: false
2025-12-14T02:25:54.659Z [nextStep] Checking if auto-pass should apply after granting priority
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_91foyham, turnPlayer: p_91foyham
[canAct] p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[priority] autoPassLoop - checking p_91foyham (ACTIVE): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_91foyham - no available actions
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.660Z [nextStep] All players auto-passed after granting priority - caller should advance step
2025-12-14T02:25:54.661Z [executeAutoPass] Cleared _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.661Z [executeAutoPass] Broadcasting state after auto-pass (ID: autopass_1765679154488_12fej)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_91foyham, match=true
[getPlayableCardIds] Player p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] manaPool= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] availableMana= { white: 0, blue: 0, black: 0, red: 0, green: 0, colorless: 0 }
[getPlayableCardIds] Total available mana: 0
[getPlayableCardIds] Checking 8 cards in hand
[getPlayableCardIds] Not checking lands: isMainPhase=false, stackIsEmpty=true, isMyTurn=true
[getPlayableCardIds] Checking 2 commanders in command zone
[getPlayableCardIds] Commander Baeloth Barrityl, Entertainer not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Commander Agent of the Shadow Thieves not playable - canCastNow=false, canPay=false
[getPlayableCardIds] Returning 0 playable card(s): []
[normalizeViewForEmit] getPlayableCardIds returned 0 cards
[normalizeViewForEmit] Not setting view.playableCards - no playable cards found
[canAct] p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
[canRespond] p_91foyham: checking instant-speed responses only
[canRespond] p_91foyham: No instant-speed responses available (returning false)
[normalizeViewForEmit] Set canAct=false, canRespond=false
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=p_91foyham, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.664Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154664_nph52) ==========
2025-12-14T02:25:54.664Z [checkAndTriggerAutoPass] Priority: p_91foyham, Phase: ending, Step: END
[canAct] p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.664Z [checkAndTriggerAutoPass] canAct check: p_91foyham isActive=true canAct=false (ID: autopass_1765679154664_nph52)
2025-12-14T02:25:54.664Z [checkAndTriggerAutoPass] p_91foyham CANNOT ACT - proceeding with auto-pass (ID: autopass_1765679154664_nph52)
2025-12-14T02:25:54.664Z [checkAndTriggerAutoPass] Scheduling auto-pass for p_91foyham with 150ms delay (ID: autopass_1765679154664_nph52)
2025-12-14T02:25:54.664Z [executeAutoPass] Broadcast complete (ID: autopass_1765679154488_12fej)
2025-12-14T02:25:54.721Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154560_8buby) ==========
2025-12-14T02:25:54.722Z [executeAutoPass] Phase: ending, Step: END
[canAct] p_91foyham: step=END, isMainPhase=false, stackIsEmpty=true
[canAct] p_91foyham: Not in main phase with empty stack (phase check failed or stack not empty) - returning FALSE
[canAct] p_91foyham: No actions available - returning FALSE
2025-12-14T02:25:54.722Z [executeAutoPass] Re-check: p_91foyham canAct=false (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.722Z [executeAutoPass] Proceeding with auto-pass for p_91foyham (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.722Z [executeAutoPass] Set _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154560_8buby)
[priority] autoPassLoop starting - active players: p_pg87s2bm, p_91foyham, p_zvvhcm6g, autoPassEnabled: p_91foyham, p_pg87s2bm, p_zvvhcm6g, currentPriority: p_zvvhcm6g, turnPlayer: p_91foyham
[canRespond] p_zvvhcm6g: checking instant-speed responses only
[canRespond] p_zvvhcm6g: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_zvvhcm6g (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_zvvhcm6g - no available actions
[canRespond] p_pg87s2bm: checking instant-speed responses only
[canRespond] p_pg87s2bm: No instant-speed responses available (returning false)
[priority] autoPassLoop - checking p_pg87s2bm (non-active): canAct=false, stack.length=0, step=END
[priority] Auto-passing for p_pg87s2bm - no available actions
2025-12-14T02:25:54.723Z [executeAutoPass] passPriority result: changed=true, advanceStep=true, resolvedNow=false (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.724Z [executeAutoPass] Advancing step after auto-pass for p_91foyham (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.724Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.724Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.724Z [nextStep] Current: ending/END
2025-12-14T02:25:54.724Z [nextStep] Priority: p_zvvhcm6g, Turn: p_91foyham
2025-12-14T02:25:54.724Z [nextStep] Call stack:
        at Object.nextStep (D:\Git\MTGEDH\server\src\state\index.ts:85:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1600:31)
        at listOnTimeout (node:internal/timers:588:17)
        at process.processTimers (node:internal/timers:523:7)
2025-12-14T02:25:54.724Z [nextStep] Advanced to phase=ending, step=CLEANUP
2025-12-14T02:25:54.724Z [nextStep] Step CLEANUP does not grant priority (Rule 502.1/514.1)
2025-12-14T02:25:54.725Z [setupCleanupDiscard] Player p_91foyham needs to discard 1 cards (hand: 8, max: 7)
2025-12-14T02:25:54.725Z [nextStep] Waiting for player to select 1 cards to discard
2025-12-14T02:25:54.725Z [nextStep] ========== CALLED ==========
2025-12-14T02:25:54.725Z [nextStep] Game: game_mj53r859
2025-12-14T02:25:54.725Z [nextStep] Current: ending/CLEANUP
2025-12-14T02:25:54.725Z [nextStep] Priority: null, Turn: p_91foyham
2025-12-14T02:25:54.725Z [nextStep] Call stack:
        at applyEvent (D:\Git\MTGEDH\server\src\state\modules\applyEvent.ts:742:9)
        at Object.applyEvent (D:\Git\MTGEDH\server\src\state\index.ts:202:35)
        at appendGameEvent (D:\Git\MTGEDH\server\src\socket\util.ts:1659:21)
        at Timeout.executeAutoPass (D:\Git\MTGEDH\server\src\socket\util.ts:1602:15)
2025-12-14T02:25:54.725Z [checkPendingInteractions] Pending: discard_selection
2025-12-14T02:25:54.725Z [nextStep] BLOCKED: Cannot advance step - pending interactions: discard_selection
2025-12-14T02:25:54.725Z [executeAutoPass] Cleared _autoPassInProgress flag for p_91foyham (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.725Z [executeAutoPass] Broadcasting state after auto-pass (ID: autopass_1765679154560_8buby)
[VIEW_FOR_DEBUG] {
  viewer: 'p_pg87s2bm',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=null, viewerId=p_pg87s2bm, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_91foyham',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=null, viewerId=p_91foyham, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
[VIEW_FOR_DEBUG] {
  viewer: 'p_zvvhcm6g',
  stackLength: 0,
  stackItems: [],
  zones: {
    p_pg87s2bm: { handCount: 7, firstKnown: [Array] },
    p_91foyham: { handCount: 8, firstKnown: [Array] },
    p_zvvhcm6g: { handCount: 7, firstKnown: [Array] }
  }
}
[normalizeViewForEmit] Checking playable cards: priority=null, viewerId=p_zvvhcm6g, match=false
[normalizeViewForEmit] Skipping playable cards - viewer doesn't have priority
[STATE_DEBUG] BROADCAST_STATE gameId=game_mj53r859 players=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] zones=[p_pg87s2bm,p_91foyham,p_zvvhcm6g] handCount=7 libraryCount=91
[STATE_DEBUG] BROADCAST_STATE librarySample gameId=game_mj53r859 { firstLibraryCard: null, lastLibraryCard: null }
2025-12-14T02:25:54.728Z [checkAndTriggerAutoPass] ========== CALLED (ID: autopass_1765679154728_jkmb6) ==========
2025-12-14T02:25:54.728Z [checkAndTriggerAutoPass] Priority: null, Phase: ending, Step: CLEANUP
2025-12-14T02:25:54.728Z [checkAndTriggerAutoPass] No priority holder, returning (ID: autopass_1765679154728_jkmb6)
2025-12-14T02:25:54.728Z [executeAutoPass] Broadcast complete (ID: autopass_1765679154560_8buby)
2025-12-14T02:25:54.814Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154653_7naee) ==========
2025-12-14T02:25:54.815Z [executeAutoPass] Phase: ending, Step: CLEANUP
2025-12-14T02:25:54.815Z [executeAutoPass] Priority changed from p_91foyham to null, aborting (ID: autopass_1765679154653_7naee)
2025-12-14T02:25:54.815Z [executeAutoPass] ========== EXECUTING for p_91foyham (ID: autopass_1765679154664_nph52) ==========
2025-12-14T02:25:54.815Z [executeAutoPass] Phase: ending, Step: CLEANUP
2025-12-14T02:25:54.815Z [executeAutoPass] Priority changed from p_91foyham to null, aborting (ID: autopass_1765679154664_nph52)
Here is the log file for the game, still going straight to discard